import{j as e}from"./framer-7QIyG1W1.js";import{r as a}from"./vendor-BfcBjVuJ.js";const r="/api/participantes",i=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,s=["Ingeniería Industrial","Ingeniería Ambiental","Ingeniería en Datos e Inteligencia Organizacional","Ingeniería en Logística y Cadena de Suministro","Ingeniería en Inteligencia Artificial","Ingeniería en Industrias Alimentarias"],n=({onSuccess:n,className:t=""})=>{const[o,l]=a.useState({apellidoPaterno:"",apellidoMaterno:"",primerNombre:"",segundoNombre:"",email:"",telefono:"",categoria:"",programa:""}),[c,d]=a.useState({}),[m,u]=a.useState({}),[p,h]=a.useState(!1),[g,x]=a.useState("idle"),[j,b]=a.useState(!1),f="Estudiante"===o.categoria,N=a.useMemo(()=>({apellidoPaterno:"Ingresa tu apellido paterno",apellidoMaterno:"Ingresa tu apellido materno",primerNombre:"Ingresa tu primer nombre",segundoNombre:"Ingresa tu segundo nombre",email:"Correo electrónico",telefono:"Teléfono (10 dígitos, opcional)"}),[]);function v(e,a){l(r=>{const i={...r,[e]:a};if("categoria"===e&&"Estudiante"!==a&&(i.programa=""),"telefono"===e){const e=String(a).replace(/\D/g,"").slice(0,10);i.telefono=e}return i})}function C(e){u(a=>({...a,[e]:!0}));const a=w({...o});d(a),"email"===e&&async function(){const e=o.email.trim();if(!i.test(e))return void x("invalid");x("checking");const a=await y(e);x(a?"ok":"taken")}()}async function y(e){try{const a=`${r}/check-email?email=${encodeURIComponent(e)}`,i=await fetch(a,{credentials:"include"});if(!i.ok)return!0;return!!(await i.json()).unique}catch{return!0}}function w(e){const a={};e.apellidoPaterno.trim()||(a.apellidoPaterno="Campo obligatorio"),e.apellidoMaterno.trim()||(a.apellidoMaterno="Campo obligatorio"),e.primerNombre.trim()||(a.primerNombre="Campo obligatorio");const r=e.email.trim();r?i.test(r)||(a.email="Formato de correo inválido"):a.email="Campo obligatorio";const s=e.telefono.trim();return s&&!/^\d{10}$/.test(s)&&(a.telefono="Deben ser 10 dígitos"),e.categoria||(a.categoria="Selecciona una categoría"),"Estudiante"===e.categoria&&(e.programa||(a.programa="Selecciona un programa")),a}return e.jsx("section",{className:`registro-section ${t}`,children:e.jsx("div",{className:"registro-container",children:j?e.jsxs("div",{className:"success-message",children:[e.jsx("div",{className:"success-icon",children:"✓"}),e.jsx("h2",{children:"¡Registro Exitoso!"}),e.jsx("p",{children:"Gracias por registrarte. Serás redirigido a la página de inicio en unos segundos..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"registro-header",children:[e.jsx("h2",{children:"Registro de Participante"}),e.jsxs("p",{className:"registro-description",children:["Completa los campos obligatorios. Si eliges ",e.jsx("b",{children:"Estudiante"}),", se te pedirá seleccionar tu ",e.jsx("b",{children:"Programa educativo"}),"."]})]}),e.jsxs("form",{noValidate:!0,onSubmit:async function(e){e.preventDefault();const a={apellidoPaterno:!0,apellidoMaterno:!0,primerNombre:!0,segundoNombre:!0,email:!0,telefono:!0,categoria:!0};"Estudiante"===o.categoria&&(a.programa=!0),u(a);const i=w(o);if(d(i),Object.keys(i).length>0)return;if(!(await y(o.email)))return x("taken"),void d(e=>({...e,email:"Este correo ya fue registrado"}));h(!0);try{const e="Estudiante"===o.categoria?o:{...o,programa:void 0},a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(409===a.status){const e=await a.json().catch(()=>null);return void("email"===e?.field?(x("taken"),d(e=>({...e,email:"Este correo ya fue registrado"}))):alert(e?.error||"Conflicto al registrar"))}if(422===a.status){const e=await a.json().catch(()=>({}));return void d(e.errors||{})}if(!a.ok){const e=await a.text();try{const a=JSON.parse(e);alert(a?.error||"Ocurrió un error. Intenta de nuevo.")}catch{alert("Ocurrió un error. Intenta de nuevo.")}return}b(!0),n?n():setTimeout(()=>window.location.href="/",3e3)}catch{alert("Error de red. Verifica tu conexión.")}finally{h(!1)}},className:"registro-form",children:[e.jsxs("fieldset",{className:"registro-fieldset",children:[e.jsx("legend",{className:"registro-legend",children:"Datos Personales"}),e.jsxs("div",{className:"registro-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apellidoPaterno",className:"form-label",children:"Apellido Paterno *"}),e.jsx("input",{id:"apellidoPaterno",name:"apellidoPaterno",type:"text",placeholder:N.apellidoPaterno,value:o.apellidoPaterno,onChange:e=>v("apellidoPaterno",e.target.value),onBlur:()=>C("apellidoPaterno"),"aria-invalid":!!c.apellidoPaterno,className:"form-input "+(c.apellidoPaterno?"input-error":""),required:!0}),m.apellidoPaterno&&c.apellidoPaterno&&e.jsx("small",{role:"alert",className:"error-message",children:c.apellidoPaterno})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apellidoMaterno",className:"form-label",children:"Apellido Materno *"}),e.jsx("input",{id:"apellidoMaterno",name:"apellidoMaterno",type:"text",placeholder:N.apellidoMaterno,value:o.apellidoMaterno,onChange:e=>v("apellidoMaterno",e.target.value),onBlur:()=>C("apellidoMaterno"),"aria-invalid":!!c.apellidoMaterno,className:"form-input "+(c.apellidoMaterno?"input-error":""),required:!0}),m.apellidoMaterno&&c.apellidoMaterno&&e.jsx("small",{role:"alert",className:"error-message",children:c.apellidoMaterno})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"primerNombre",className:"form-label",children:"Primer Nombre *"}),e.jsx("input",{id:"primerNombre",name:"primerNombre",type:"text",placeholder:N.primerNombre,value:o.primerNombre,onChange:e=>v("primerNombre",e.target.value),onBlur:()=>C("primerNombre"),"aria-invalid":!!c.primerNombre,className:"form-input "+(c.primerNombre?"input-error":""),required:!0}),m.primerNombre&&c.primerNombre&&e.jsx("small",{role:"alert",className:"error-message",children:c.primerNombre})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"segundoNombre",className:"form-label",children:"Segundo Nombre"}),e.jsx("input",{id:"segundoNombre",name:"segundoNombre",type:"text",placeholder:N.segundoNombre,value:o.segundoNombre,onChange:e=>v("segundoNombre",e.target.value),onBlur:()=>C("segundoNombre"),className:"form-input"})]})]})]}),e.jsxs("fieldset",{className:"registro-fieldset",children:[e.jsx("legend",{className:"registro-legend",children:"Información de Contacto"}),e.jsxs("div",{className:"registro-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",className:"form-label",children:"Correo Electrónico *"}),e.jsx("input",{id:"email",name:"email",type:"email",placeholder:N.email,value:o.email,onChange:e=>v("email",e.target.value),onBlur:()=>C("email"),"aria-invalid":!!c.email||"taken"===g,className:"form-input "+(c.email||"taken"===g?"input-error":""),required:!0}),e.jsxs("div",{className:"email-status",children:["checking"===g&&e.jsx("small",{className:"checking",children:"Verificando disponibilidad…"}),"ok"===g&&o.email&&e.jsx("small",{className:"success",children:"✓ Correo disponible"}),"invalid"===g&&e.jsx("small",{role:"alert",className:"error",children:"Formato de correo inválido"}),"taken"===g&&e.jsx("small",{role:"alert",className:"error",children:"Este correo ya fue registrado"})]}),m.email&&c.email&&e.jsx("small",{role:"alert",className:"error-message",children:c.email})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"telefono",className:"form-label",children:"Teléfono (opcional)"}),e.jsx("input",{id:"telefono",name:"telefono",type:"tel",inputMode:"numeric",pattern:"[0-9]{10}",placeholder:N.telefono,value:o.telefono,onChange:e=>v("telefono",e.target.value),onBlur:()=>C("telefono"),"aria-invalid":!!c.telefono,className:"form-input "+(c.telefono?"input-error":"")}),m.telefono&&c.telefono&&e.jsx("small",{role:"alert",className:"error-message",children:c.telefono})]})]})]}),e.jsxs("fieldset",{className:"registro-fieldset",children:[e.jsx("legend",{className:"registro-legend",children:"Información Académica"}),e.jsxs("div",{className:"registro-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"categoria",className:"form-label",children:"Categoría del Participante *"}),e.jsxs("select",{id:"categoria",name:"categoria",value:o.categoria,onChange:e=>v("categoria",e.target.value),onBlur:()=>C("categoria"),"aria-invalid":!!c.categoria,className:"form-select "+(c.categoria?"input-error":""),required:!0,children:[e.jsx("option",{value:"",children:"Selecciona una categoría"}),e.jsx("option",{value:"Estudiante",children:"Estudiante"}),e.jsx("option",{value:"Ponente",children:"Ponente"}),e.jsx("option",{value:"Asistente externo",children:"Asistente externo"})]}),m.categoria&&c.categoria&&e.jsx("small",{role:"alert",className:"error-message",children:c.categoria})]}),f&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"programa",className:"form-label",children:"Programa Educativo *"}),e.jsxs("select",{id:"programa",name:"programa",value:o.programa,onChange:e=>v("programa",e.target.value),onBlur:()=>C("programa"),"aria-invalid":!!c.programa,className:"form-select "+(c.programa?"input-error":""),required:f,children:[e.jsx("option",{value:"",children:"Selecciona un programa"}),s.map(a=>e.jsx("option",{value:a,children:a},a))]}),m.programa&&c.programa&&e.jsx("small",{role:"alert",className:"error-message",children:c.programa})]})]})]}),e.jsx("div",{className:"form-submit",children:e.jsx("button",{type:"submit",className:"submit-button "+(p?"submitting":""),disabled:p||"checking"===g,children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Enviando..."]}):"Enviar Registro"})})]})]})})})},t=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,o="/api",l=({className:r=""})=>{const[i,s]=a.useState(""),[n,l]=a.useState("idle"),[c,d]=a.useState(""),[m,u]=a.useState(null),[p,h]=a.useState([]),[g,x]=a.useState({}),[j,b]=a.useState({}),f=a.useMemo(()=>"Correo electrónico",[]);a.useEffect(()=>{(async()=>{try{const e=await fetch(`${o}/actividades?tipo=Workshop&activa=true`,{credentials:"include"});if(e.ok){const a=(await e.json()).filter(e=>{const a=new Date(e.fechaInicio),r=new Date(e.fechaFin);return a>=new Date("2025-09-22T09:00:00-06:00")&&r<=new Date("2025-09-23T23:59:59-06:00")});h(a)}}catch(e){console.error("Error cargando workshops:",e)}})()},[]),a.useEffect(()=>{const e=i.trim();if(!e)return l("idle"),d(""),u(null),void x({});if(!t.test(e))return l("invalid"),d(""),u(null),void x({});l("typing"),d("");const a=setTimeout(async()=>{l("checking");try{const r=await fetch(`${o}/participantes?email=${encodeURIComponent(e)}`,{credentials:"include"});if(404===r.status)return u(null),x({}),void l("notfound");if(!r.ok){const e=await r.text().catch(()=>"");return l("error"),d(e||"Error del servidor. Intenta nuevamente."),u(null),void x({})}const i={id:(a=await r.json()).id,apellidoPaterno:a.apellido_paterno||"",apellidoMaterno:a.apellido_materno||"",primerNombre:a.primer_nombre||"",segundoNombre:a.segundo_nombre||null,email:a.email||"",telefono:a.telefono||void 0,brazalete:a.brazalete||null,categoria:a.categoria,programa:a.programa||null};u(i),l("found");const s=await fetch(`${o}/workshops/inscripciones?email=${encodeURIComponent(e)}`,{credentials:"include"});if(!s.ok){const e=await s.text().catch(()=>"");return l("error"),d(e||"No se pudieron consultar tus inscripciones."),void x({})}const n=await s.json(),t={};n.forEach(e=>{t[e.actividadId]=e}),x(t)}catch(r){console.error("Error en búsqueda:",r),l("error"),d("Error de red. Verifica tu conexión."),u(null),x({})}var a},600);return()=>clearTimeout(a)},[i]);const N=a.useMemo(()=>[...p].sort((e,a)=>new Date(e.fechaInicio).getTime()-new Date(a.fechaInicio).getTime()),[p]);function v(e){try{return new Date(e).toLocaleString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"America/Cancun"})}catch{return new Date(e).toLocaleString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}}return e.jsx("section",{className:`registro-section ${r}`,children:e.jsxs("div",{className:"registro-container",children:[e.jsxs("div",{className:"registro-header",children:[e.jsx("h2",{children:"Inscripción a Workshops"}),e.jsxs("p",{className:"registro-description",children:["Ingresa tu correo para ver tus datos e ",e.jsx("b",{children:"inscribirte"}),". Si el cupo está lleno, puedes entrar a ",e.jsx("b",{children:"lista de espera"}),". Una persona solo puede tener ",e.jsx("b",{children:"1 workshop"})," activo."]})]}),e.jsxs("div",{className:"registro-form",children:[e.jsxs("div",{className:"form-group",style:{marginBottom:"2rem"},children:[e.jsx("label",{htmlFor:"emailLookup",className:"form-label",children:"Correo electrónico"}),e.jsx("input",{id:"emailLookup",type:"email",placeholder:f,value:i,onChange:e=>s(e.target.value),className:"form-input "+("invalid"===n||"notfound"===n||"error"===n?"input-error":"")}),e.jsxs("div",{className:"email-status",children:["checking"===n&&e.jsx("small",{className:"checking",children:"🔍 Buscando..."}),"invalid"===n&&i&&e.jsx("small",{className:"error",children:"❌ Formato de correo inválido."}),"notfound"===n&&e.jsx("small",{className:"error",children:"❌ No encontramos este correo registrado."}),"error"===n&&e.jsxs("small",{className:"error",children:["⚠️ ",c]}),"found"===n&&e.jsx("small",{className:"success",children:"✅ ¡Participante encontrado!"})]})]}),m&&e.jsxs("div",{className:"info-box",children:[e.jsx("h3",{children:"👤 Tus datos registrados"}),e.jsxs("div",{className:"info-box-content",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nombre:"})," ",`${m.primerNombre} ${m.segundoNombre||""} ${m.apellidoPaterno} ${m.apellidoMaterno}`]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Correo:"})," ",m.email]}),m.telefono&&e.jsxs("div",{children:[e.jsx("strong",{children:"Teléfono:"})," ",m.telefono]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Categoría:"})," ",m.categoria,"Estudiante"===m.categoria&&m.programa&&e.jsxs("span",{children:[" — ",m.programa]})]})]})]}),m&&p.length>0&&e.jsx("div",{className:"conference-list",children:N.map(a=>{const r=g[a.id],i=!!j[a.id],s=function(e){return e.estadoCupo?"LLENO"===e.estadoCupo:"number"==typeof e.cuposDisponibles&&e.cuposDisponibles<=0}(a),n=["conference-card",r?"is-registered":""].join(" ");return e.jsxs("div",{className:n,children:[r&&e.jsx("div",{className:"badge-success",children:"inscrito"===r.estado?"✓ Inscrito":"🕒 Lista de espera"}),e.jsx("h4",{children:a.titulo}),e.jsxs("div",{className:"fecha-lugar",children:["📅 ",v(a.fechaInicio),a.lugar&&e.jsxs("span",{children:[" • 📍 ",a.lugar]})]}),r?e.jsx("button",{type:"button",onClick:()=>async function(e){if(m&&confirm("¿Seguro que deseas cancelar tu inscripción?")){b(a=>({...a,[e]:!0}));try{const a=await fetch(`${o}/workshops/inscripciones`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:m.email.trim(),actividadId:e})}),r=await a.json().catch(()=>({}));if(!a.ok)return void alert(r?.error||"No fue posible cancelar.");x(a=>{const{[e]:r,...i}=a;return i})}catch(a){console.error(a),alert("Error de red. Inténtalo de nuevo.")}finally{b(a=>({...a,[e]:!1}))}}}(a.id),disabled:i,className:"submit-button",children:i?"⏳ Cancelando...":"❌ Cancelar inscripción"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>async function(e){if(m){b(a=>({...a,[e]:!0}));try{const a=await fetch(`${o}/workshops/inscripciones`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:m.email.trim(),actividadId:e})}),r=await a.json().catch(()=>({}));if(409===a.status||422===a.status||!a.ok)return void alert(r?.error||"No fue posible inscribirte.");const{data:i}=r.ok?r:{data:r},s=i??r;x(a=>({...a,[e]:s}))}catch(a){console.error(a),alert("Error de red. Inténtalo de nuevo.")}finally{b(a=>({...a,[e]:!1}))}}}(a.id),disabled:i,className:"submit-button",children:i?"⏳ Procesando...":s?"📝 Entrar a lista de espera":"✅ Inscribirme"}),"number"==typeof a.cuposDisponibles&&e.jsxs("small",{className:"email-status",children:[a.cuposDisponibles," lugares disponibles"]}),"LLENO"===a.estadoCupo&&e.jsx("small",{className:"email-status error",children:"Cupo lleno"})]})]},a.id)})}),(m&&0===p.length||!m&&"idle"===n)&&e.jsx("div",{className:"initial-state-message",children:m?e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:"📅 No hay workshops disponibles"}),e.jsx("p",{children:"Actualmente no hay workshops programados. Vuelve más tarde."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"icon",children:"🎯"}),e.jsx("h3",{children:"¿Listo para inscribirte a un workshop?"}),e.jsx("p",{children:"Ingresa tu correo electrónico registrado para comenzar."})]})})]})]})})},c=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,d="/api",m=({className:r="",showHeader:i=!0})=>{const[s,n]=a.useState(""),[t,o]=a.useState("idle"),[l,m]=a.useState(""),[u,p]=a.useState(null),[h,g]=a.useState([]),[x,j]=a.useState({}),[b,f]=a.useState({}),[N,v]=a.useState(""),[C,y]=a.useState(!1);a.useMemo(()=>"Correo electrónico",[]),a.useEffect(()=>{(async()=>{try{const e=await fetch(`${d}/actividades?ventana=disponibles`,{credentials:"include"});if(e.ok){const a=await e.json();g(a)}}catch(e){console.error("Error cargando actividades:",e)}})()},[]),a.useEffect(()=>{const e=s.trim();if(!e)return o("idle"),m(""),p(null),void j({});if(!c.test(e))return o("invalid"),m(""),p(null),void j({});o("typing"),m("");const a=setTimeout(async()=>{o("checking");try{const a=await fetch(`${d}/participantes?email=${encodeURIComponent(e)}`,{credentials:"include"});if(404===a.status)return p(null),j({}),void o("notfound");if(!a.ok){const e=await a.text().catch(()=>"");return o("error"),m(e||"Error del servidor. Intenta nuevamente."),p(null),void j({})}const r=await a.json();p(r),o("found");const i=await fetch(`${d}/asistencias?email=${encodeURIComponent(e)}`,{credentials:"include"});if(!i.ok){const e=await i.text().catch(()=>"");return o("error"),m(e||"No se pudieron consultar tus asistencias."),void j({})}const s=await i.json(),n={};s.forEach(e=>{n[e.actividadId]=e}),j(n)}catch(a){console.error("Error en búsqueda:",a),o("error"),m("Error de red. Verifica tu conexión."),p(null),j({})}},600);return()=>clearTimeout(a)},[s]);const w=a.useMemo(()=>{const e=new Date,a=a=>{const r=new Date(a.fechaInicio),i=new Date(a.fechaFin);return e>=r&&e<=i?1:e<r?2:3};return[...h].sort((e,r)=>{const i=a(e),s=a(r);return i!==s?i-s:new Date(e.fechaInicio).getTime()-new Date(r.fechaInicio).getTime()})},[h]);function E(e){try{return new Date(e).toLocaleString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"America/Cancun"})}catch{return new Date(e).toLocaleString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}}return e.jsx("section",{className:`registro-section ${r}`,children:e.jsxs("div",{className:"registro-container",children:[e.jsxs("div",{className:"registro-header",children:[e.jsx("h2",{children:"Asistencia a Actividades"}),e.jsx("p",{className:"registro-description",children:"Ingresa tu correo para ver tus datos y confirmar tu asistencia."})]}),e.jsxs("div",{className:"registro-form",children:[e.jsxs("div",{className:"form-group",style:{marginBottom:"2rem"},children:[e.jsx("label",{htmlFor:"emailLookup",className:"form-label",children:"Correo electrónico"}),e.jsx("input",{id:"emailLookup",type:"email",placeholder:"Correo electrónico",value:s,onChange:e=>n(e.target.value),className:"form-input "+("invalid"===t||"notfound"===t||"error"===t?"input-error":"")}),e.jsxs("div",{className:"email-status",children:["checking"===t&&e.jsx("small",{className:"checking",children:"🔍 Buscando..."}),"invalid"===t&&s&&e.jsx("small",{className:"error",children:"❌ Formato de correo inválido."}),"notfound"===t&&e.jsx("small",{className:"error",children:"❌ No encontramos este correo registrado."}),"error"===t&&e.jsxs("small",{className:"error",children:["⚠️ ",l]}),"found"===t&&e.jsx("small",{className:"success",children:"✅ ¡Participante encontrado!"})]})]}),u&&e.jsxs("div",{className:"info-box",children:[e.jsx("h3",{children:"👤 Tus datos registrados"}),e.jsxs("div",{className:"info-box-content",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nombre:"})," ",`${u.primer_nombre} ${u.segundo_nombre||""} ${u.apellido_paterno} ${u.apellido_materno}`]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Correo:"})," ",u.email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Teléfono:"})," ",u.telefono]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Brazalete:"})," ",u.brazalete??"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Categoría:"})," ",u.categoria,"Estudiante"===u.categoria&&u.programa&&e.jsxs("span",{children:[" — ",u.programa]})]})]})]}),u&&h.length>0&&e.jsx("div",{className:"conference-list",children:w.map(a=>{const r=!!x[a.id],i=!!b[a.id],s=["conference-card",r?"is-registered":""].join(" ");return e.jsxs("div",{className:s,children:[r&&e.jsx("div",{className:"badge-success",children:"✓ Registrado"}),a.estadoCupo&&e.jsxs("div",{className:`cupo-badge ${a.estadoCupo.toLowerCase()}`,children:["DISPONIBLE"===a.estadoCupo&&"🟢","CASI_LLENO"===a.estadoCupo&&"🟡","LLENO"===a.estadoCupo&&"🔴",void 0!==a.disponibles?` ${a.disponibles}/${a.cupoMaximo} disponibles`:` ${a.estadoCupo}`]}),e.jsx("h4",{children:a.titulo}),a.ponente&&e.jsxs("p",{className:"ponente",children:["👨‍🏫 ",a.ponente]}),e.jsxs("div",{className:"fecha-lugar",children:["📅 ",E(a.fechaInicio),a.lugar&&e.jsxs("span",{children:[" • 📍 ",a.lugar]})]}),r?e.jsxs("div",{className:"confirmation-message",children:[e.jsx("span",{children:"✅ Asistencia confirmada"}),e.jsxs("small",{children:["(",new Date(x[a.id].creado).toLocaleString("es-MX",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),")"]})]}):e.jsx("button",{type:"button",onClick:()=>async function(e){if(u){f(a=>({...a,[e]:!0}));try{const a=await fetch(`${d}/asistencias`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:u.email.trim(),actividadId:e})}),r=await a.json().catch(()=>({}));if(409===a.status)return void alert("Ya tienes registrada la asistencia para esta actividad.");if(!a.ok)return void alert(r?.error||`Error ${a.status}: No se pudo registrar asistencia`);const i=(new Date).toISOString();j(a=>({...a,[e]:{actividadId:e,creado:i}}))}catch(a){console.error("Error de red:",a),alert("Error de red al confirmar asistencia. Verifica tu conexión.")}finally{f(a=>({...a,[e]:!1}))}}}(a.id),disabled:i||"LLENO"===a.estadoCupo,className:"submit-button "+("LLENO"===a.estadoCupo?"disabled":""),children:i?"⏳ Registrando...":"LLENO"===a.estadoCupo?"🚫 Cupo lleno":"✅ Confirmar asistencia"})]},a.id)})}),(u&&0===h.length||!u&&"idle"===t)&&e.jsx("div",{className:"initial-state-message",children:u?e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:"📅 No hay actividades disponibles en este momento"}),e.jsx("p",{children:"Vuelve a intentar dentro de la ventana de marcaje."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"icon",children:"🎯"}),e.jsx("h3",{children:"¿Listo para registrar tu asistencia?"}),e.jsx("p",{children:"Ingresa tu correo electrónico registrado para comenzar."})]})})]})]})})},u="/api",p=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,h=({className:r="",showHeader:i=!0})=>{const[s,n]=a.useState(""),[t,o]=a.useState("idle"),[l,c]=a.useState(null),[d,m]=a.useState(!1);a.useEffect(()=>{if(!s)return o("idle"),void c(null);if(!p.test(s))return o("invalid"),void c(null);o("typing");const e=setTimeout(async()=>{o("checking");try{const e=await fetch(`${u}/constancia/verificar?email=${encodeURIComponent(s)}`,{credentials:"include"});if(404===e.status)return c(null),void o("notfound");if(!e.ok)throw new Error("Error verificando participante");const a=await e.json();c(a),o("found")}catch(e){console.error(e),o("invalid"),c(null)}},700);return()=>clearTimeout(e)},[s]);return e.jsx("section",{className:`registro-section ${r}`,children:e.jsxs("div",{className:"registro-container",children:[e.jsxs("div",{className:"registro-header",children:[e.jsx("h2",{children:"Constancias"}),e.jsx("p",{className:"registro-description",children:"Ingresa tu correo registrado para verificar tu elegibilidad y descargar tu constancia."})]}),e.jsxs("div",{className:"registro-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"emailLookup",className:"form-label",children:"Correo electrónico"}),e.jsx("input",{id:"emailLookup",type:"email",placeholder:"Correo electrónico",value:s,onChange:e=>n(e.target.value.trim()),className:"form-input "+("invalid"===t?"input-error":""),"aria-invalid":"invalid"===t}),e.jsxs("div",{className:"email-status",children:["checking"===t&&e.jsx("small",{className:"checking",children:"Verificando disponibilidad…"}),"invalid"===t&&s&&e.jsx("small",{role:"alert",className:"error",children:"Formato de correo inválido"}),"notfound"===t&&e.jsx("small",{role:"alert",className:"error",children:"No encontramos este correo registrado"}),"found"===t&&l&&(l.puedeObtenerConstancia?e.jsx("small",{className:"success",children:"✓ Elegible para constancia"}):e.jsx("small",{className:"checking",children:"Sin asistencias suficientes"}))]}),e.jsx("small",{className:"form-help",children:"Usa el correo con el que te registraste en el evento."})]}),"checking"===t&&e.jsx("div",{className:"constancia-loading",children:e.jsxs("div",{className:"loading-skeleton",children:[e.jsx("div",{className:"skeleton-line"}),e.jsx("div",{className:"skeleton-box"}),e.jsx("div",{className:"skeleton-line short"})]})}),l&&"found"===t&&e.jsxs("div",{className:"constancia-result",children:[e.jsxs("div",{className:"participant-info "+(l.puedeObtenerConstancia?"eligible":"not-eligible"),children:[e.jsxs("div",{className:"participant-header",children:[e.jsx("h3",{children:"👤 Participante"}),e.jsx("span",{className:"status-badge "+(l.puedeObtenerConstancia?"success":"warning"),children:l.puedeObtenerConstancia?"ELEGIBLE":"FALTA ASISTENCIA"})]}),e.jsxs("div",{className:"participant-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("strong",{children:"Nombre:"})," ",l.participante.primerNombre," ",l.participante.segundoNombre||""," ",l.participante.apellidoPaterno," ",l.participante.apellidoMaterno]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("strong",{children:"Categoría:"})," ",l.participante.categoria,"Estudiante"===l.participante.categoria&&l.participante.programa&&e.jsxs("span",{children:[" — ",l.participante.programa]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("strong",{children:"Email:"})," ",l.participante.email]})]})]}),l.asistencias.length>0?e.jsxs("div",{className:"asistencias-section",children:[e.jsxs("h4",{children:["📋 Conferencias asistidas (",l.asistencias.length,")"]}),e.jsx("div",{className:"asistencias-list",children:l.asistencias.map((a,r)=>e.jsxs("div",{className:"asistencia-item",children:[e.jsx("div",{className:"asistencia-indicator"}),e.jsxs("div",{className:"asistencia-content",children:[e.jsx("div",{className:"asistencia-title",children:a.titulo}),e.jsxs("div",{className:"asistencia-details",children:[a.ponente&&e.jsxs("span",{children:["👨‍🏫 ",a.ponente," • "]}),e.jsxs("span",{children:["📅 ",new Date(a.fecha).toLocaleDateString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),a.lugar&&e.jsxs("span",{children:[" • 📍 ",a.lugar]})]}),e.jsxs("div",{className:"asistencia-registered",children:["✅ Registrada el ",new Date(a.fechaAsistencia).toLocaleDateString("es-MX")]})]})]},r))})]}):e.jsxs("div",{className:"no-asistencias",children:[e.jsx("div",{className:"no-asistencias-icon",children:"📋"}),e.jsx("h4",{children:"Sin asistencias registradas"}),e.jsx("p",{children:"Para obtener tu constancia, registra al menos una asistencia."}),e.jsx("a",{href:"/registro",className:"link-button",children:"Registrar asistencia →"})]})]}),!l&&"idle"===t&&e.jsxs("div",{className:"constancia-welcome",children:[e.jsx("div",{className:"welcome-icon",children:"🏆"}),e.jsx("h3",{children:"¿Listo para obtener tu constancia?"}),e.jsx("p",{children:"Verifica tu correo y descarga tu PDF si cumples los requisitos."}),e.jsxs("div",{className:"requirements-box",children:[e.jsx("strong",{children:"Requisitos:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Estar registrado como participante"}),e.jsx("li",{children:"Al menos una asistencia confirmada"}),e.jsx("li",{children:"Datos completos en el sistema"})]})]})]}),l?.puedeObtenerConstancia&&e.jsx("div",{className:"form-submit",children:e.jsx("button",{onClick:async()=>{if(l){m(!0);try{const e=await fetch(`${u}/constancia/generar?email=${encodeURIComponent(s)}`,{credentials:"include"});if(!e.ok){const a=await e.json().catch(()=>null);return void alert(a?.error||"Error generando constancia")}const a=await e.blob(),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=`constancia-${l.participante.primerNombre}-${l.participante.apellidoPaterno}.pdf`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(r),document.body.removeChild(i)}catch(e){console.error(e),alert("Error de red al descargar constancia")}finally{m(!1)}}},disabled:d,className:"submit-button "+(d?"submitting":""),children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Generando constancia..."]}):"📄 Descargar Constancia PDF"})}),l&&!l.puedeObtenerConstancia&&e.jsxs("div",{className:"not-eligible-cta",children:[e.jsx("div",{className:"not-eligible-icon",children:"⚠️"}),e.jsx("h3",{children:"Constancia no disponible"}),e.jsx("p",{children:"Registra tu asistencia para habilitar la descarga."}),e.jsx("a",{href:"/asistencia",className:"cta-button",children:"📋 Registrar asistencia"})]})]})]})})},g="/api/equipos",x=({onSuccess:r,className:i=""})=>{const[s,n]=a.useState({nombreEquipo:"",emailCapitan:"",emailsMiembros:["","","","",""]}),[t,o]=a.useState({}),[l,c]=a.useState({}),[d,m]=a.useState(!1),[u,p]=a.useState(!1),[h,x]=a.useState("idle"),[j,b]=a.useState({}),[f,N]=a.useState({}),v=a.useCallback(async e=>{if(e.trim()){x("checking");try{const a=await fetch(`${g}/check-name?nombre=${encodeURIComponent(e)}`),r=await a.json();a.ok?x(r.available?"available":"taken"):x("idle")}catch{x("idle")}}else x("idle")},[]),C=a.useCallback(async(e,a)=>{if(!e.trim())return b(e=>({...e,[a]:"idle"})),void N(e=>({...e,[a]:null}));b(e=>({...e,[a]:"checking"}));try{const r=await fetch(`${g}/check-participant?email=${encodeURIComponent(e)}`),i=await r.json();r.ok?i.valid?(b(e=>({...e,[a]:"valid"})),N(e=>({...e,[a]:i.participante}))):(b(e=>({...e,[a]:"invalid"})),N(e=>({...e,[a]:i.participante})),o(e=>({...e,[a]:i.error}))):(b(e=>({...e,[a]:"error"})),N(e=>({...e,[a]:null})))}catch{b(e=>({...e,[a]:"error"})),N(e=>({...e,[a]:null}))}},[]);a.useEffect(()=>{const e=setTimeout(()=>{s.nombreEquipo.trim()&&v(s.nombreEquipo.trim())},500);return()=>clearTimeout(e)},[s.nombreEquipo,v]);const y=(e,a,r=!1)=>{if(r)n(e=>({...e,emailCapitan:a})),o(e=>{const a={...e};return delete a.emailCapitan,a});else{const r=[...s.emailsMiembros];r[e]=a,n(e=>({...e,emailsMiembros:r})),o(a=>{const r={...a};return delete r[`miembro${e}`],r})}},w=(e,a)=>{c(a=>({...a,[e]:!0}));a&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)&&C(a,e)},E=(a,r)=>{const i=j[a];return"checking"===i?e.jsx("small",{className:"checking",children:"Verificando participante..."}):"valid"===i&&r?e.jsxs("div",{className:"participant-info",children:[e.jsxs("small",{className:"success",children:["✓ ",r.primerNombre," ",r.apellidoPaterno]}),r.programa&&e.jsx("small",{className:"program",children:r.programa})]}):"invalid"===i?e.jsx("small",{className:"error",children:t[a]||"Participante no válido"}):"error"===i?e.jsx("small",{className:"error",children:"Error verificando participante"}):null};return e.jsx("section",{className:`registro-section ${i}`,children:e.jsx("div",{className:"registro-container",children:u?e.jsxs("div",{className:"success-message",children:[e.jsx("div",{className:"success-icon",children:"✓"}),e.jsx("h2",{children:"¡Equipo Registrado Exitosamente!"}),e.jsxs("p",{children:['Tu equipo "',e.jsx("strong",{children:s.nombreEquipo}),'" ha sido registrado correctamente para el concurso. Serás redirigido a la página principal en unos segundos...']})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"registro-header",children:[e.jsx("h2",{children:"Registro de Equipo - Concurso"}),e.jsxs("p",{className:"registro-description",children:["Registra tu equipo para el concurso. Los equipos deben tener exactamente ",e.jsx("b",{children:"6 integrantes"}),". Abierto ",e.jsx("b",{children:"para todas las personas"})," previamente registradas. Solo se permite ",e.jsx("b",{children:"un equipo por persona"}),"."]})]}),e.jsxs("form",{noValidate:!0,onSubmit:async e=>{e.preventDefault();const a={nombreEquipo:!0,emailCapitan:!0};if(s.emailsMiembros.forEach((e,r)=>{a[`miembro${r}`]=!0}),c(a),!(()=>{const e={};s.nombreEquipo.trim()?"taken"===h&&(e.nombreEquipo="Este nombre ya está en uso"):e.nombreEquipo="Nombre del equipo obligatorio";const a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;s.emailCapitan.trim()?a.test(s.emailCapitan)||(e.emailCapitan="Formato de email inválido"):e.emailCapitan="Email del capitán obligatorio";const r=[s.emailCapitan,...s.emailsMiembros.filter(e=>e.trim())];return new Set(r).size!==r.length&&(e.emailCapitan="No pueden haber emails duplicados"),s.emailsMiembros.forEach((r,i)=>{const s=`miembro${i}`;r.trim()?a.test(r)||(e[s]="Formato de email inválido"):e[s]="Email de miembro obligatorio"}),o(e),0===Object.keys(e).length})())return;if("available"===h&&"valid"===j.emailCapitan&&s.emailsMiembros.every((e,a)=>"valid"===j[`miembro${a}`])){m(!0);try{const e=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({nombreEquipo:s.nombreEquipo.trim(),emailCapitan:s.emailCapitan.trim(),emailsMiembros:s.emailsMiembros.map(e=>e.trim())})}),a=await e.json().catch(()=>({}));if(422===e.status)return void o(a.errors||{});if(400===e.status||409===e.status)return void(Array.isArray(a.details)?alert(`Error en el registro:\n\n${a.details.join("\n")}`):alert(a.error||"Error en el registro del equipo"));if(!e.ok)return void alert(a.error||"Error interno del servidor");p(!0),r?r():setTimeout(()=>{window.location.href="/"},3e3)}catch(i){console.error("Error en el registro:",i),alert("Error de red. Verifica tu conexión.")}finally{m(!1)}}else o(e=>({...e,nombreEquipo:"available"!==h?"Verifica el nombre del equipo":e.nombreEquipo,emailCapitan:"valid"!==j.emailCapitan?"Verifica el email del capitán":e.emailCapitan}))},className:"registro-form",children:[e.jsxs("fieldset",{className:"registro-fieldset",children:[e.jsx("legend",{className:"registro-legend",children:"Información del Equipo"}),e.jsx("div",{className:"registro-grid",children:e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{htmlFor:"nombreEquipo",className:"form-label",children:"Nombre del Equipo *"}),e.jsx("input",{id:"nombreEquipo",name:"nombreEquipo",type:"text",placeholder:"Ingresa un nombre único para tu equipo",value:s.nombreEquipo,onChange:e=>{return a="nombreEquipo",r=e.target.value,n(e=>({...e,[a]:r})),void o(e=>{const r={...e};return delete r[a],r});var a,r},onBlur:()=>c(e=>({...e,nombreEquipo:!0})),className:"form-input "+(t.nombreEquipo?"input-error":""),required:!0}),e.jsxs("div",{className:"equipo-name-status",children:["checking"===h&&e.jsx("small",{className:"checking",children:"Verificando disponibilidad..."}),"available"===h&&s.nombreEquipo&&e.jsx("small",{className:"success",children:"✓ Nombre disponible"}),"taken"===h&&e.jsx("small",{className:"error",children:"Este nombre ya está en uso"})]}),l.nombreEquipo&&t.nombreEquipo&&e.jsx("small",{role:"alert",className:"error-message",children:t.nombreEquipo})]})})]}),e.jsxs("fieldset",{className:"registro-fieldset",children:[e.jsx("legend",{className:"registro-legend",children:"Capitán del Equipo"}),e.jsx("div",{className:"registro-grid",children:e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{htmlFor:"emailCapitan",className:"form-label",children:"Email del Capitán *"}),e.jsx("input",{id:"emailCapitan",name:"emailCapitan",type:"email",placeholder:"correo.capitan@ejemplo.com",value:s.emailCapitan,onChange:e=>y(0,e.target.value,!0),onBlur:e=>w("emailCapitan",e.target.value),className:"form-input "+(t.emailCapitan?"input-error":""),required:!0}),e.jsx("div",{className:"participant-status",children:E("emailCapitan",f.emailCapitan)}),l.emailCapitan&&t.emailCapitan&&e.jsx("small",{role:"alert",className:"error-message",children:t.emailCapitan})]})})]}),e.jsxs("fieldset",{className:"registro-fieldset",children:[e.jsx("legend",{className:"registro-legend",children:"Miembros del Equipo (5 adicionales)"}),e.jsx("div",{className:"registro-grid",children:s.emailsMiembros.map((a,r)=>e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:`miembro${r}`,className:"form-label",children:["Miembro ",r+1," *"]}),e.jsx("input",{id:`miembro${r}`,name:`miembro${r}`,type:"email",placeholder:`correo.miembro${r+1}@ejemplo.com`,value:a,onChange:e=>y(r,e.target.value),onBlur:e=>w(`miembro${r}`,e.target.value),className:"form-input "+(t[`miembro${r}`]?"input-error":""),required:!0}),e.jsx("div",{className:"participant-status",children:E(`miembro${r}`,f[`miembro${r}`])}),l[`miembro${r}`]&&t[`miembro${r}`]&&e.jsx("small",{role:"alert",className:"error-message",children:t[`miembro${r}`]})]},r))})]}),e.jsx("div",{className:"form-submit",children:e.jsx("button",{type:"submit",className:"submit-button "+(d?"submitting":""),disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Registrando Equipo..."]}):"Registrar Equipo"})})]})]})})})},j=()=>{const[r,i]=a.useState("registro"),[s,t]=a.useState(!1),[o,c]=a.useState(!1),d=a.useRef(null),u=()=>{if(d.current){const{scrollLeft:e,scrollWidth:a,clientWidth:r}=d.current;t(e>0),c(e<a-r)}},p=e=>{if(d.current){const{scrollLeft:a,scrollWidth:r,clientWidth:i}=d.current,s="left"===e?0:r-i;a!==s&&d.current.scrollTo({left:s,behavior:"smooth"})}},g=()=>{if(d.current){const e=d.current.querySelector(".tab-button.active");if(e){const a=d.current.getBoundingClientRect(),r=e.getBoundingClientRect(),i=e.offsetLeft-a.width/2+r.width/2;d.current.scrollTo({left:i,behavior:"smooth"})}}};return a.useEffect(()=>(u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)),[]),a.useEffect(()=>{const e=d.current;if(e)return e.addEventListener("scroll",u),()=>e.removeEventListener("scroll",u)},[]),a.useEffect(()=>{setTimeout(g,100)},[r]),e.jsx("main",{className:"w-full mt-[0px] md:mt-[0px]",children:e.jsxs("div",{className:"registro-combined-page",children:[e.jsx("div",{className:"tabs-container",children:e.jsxs("div",{className:`tabs-navigation ${s?"show-left-gradient":""} ${o?"show-right-gradient":""}`,children:[s&&e.jsx("button",{className:"scroll-arrow scroll-arrow-left",onClick:()=>p("left"),type:"button","aria-label":"Scroll tabs left",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"15,18 9,12 15,6"})})}),e.jsxs("div",{className:"tabs-wrapper",ref:d,onScroll:u,children:[e.jsxs("button",{className:"tab-button "+("registro"===r?"active":""),onClick:()=>i("registro"),type:"button",children:[e.jsx("span",{className:"tab-icon",children:"📝"}),e.jsx("span",{className:"tab-text",children:"Registro"})]}),e.jsxs("button",{className:"tab-button "+("workshop"===r?"active":""),onClick:()=>i("workshop"),type:"button",children:[e.jsx("span",{className:"tab-icon",children:"⚙️"}),e.jsx("span",{className:"tab-text",children:"Workshop"})]}),e.jsxs("button",{className:"tab-button "+("asistencia"===r?"active":""),onClick:()=>i("asistencia"),type:"button",children:[e.jsx("span",{className:"tab-icon",children:"📋"}),e.jsx("span",{className:"tab-text",children:"Asistencia"})]}),e.jsxs("button",{className:"tab-button "+("constancia"===r?"active":""),onClick:()=>i("constancia"),type:"button",children:[e.jsx("span",{className:"tab-icon",children:"🏆"}),e.jsx("span",{className:"tab-text",children:"Constancia"})]}),e.jsxs("button",{className:"tab-button "+("concurso"===r?"active":""),onClick:()=>i("concurso"),type:"button",children:[e.jsx("span",{className:"tab-icon",children:"⚽"}),e.jsx("span",{className:"tab-text",children:"Concurso"})]})]}),o&&e.jsx("button",{className:"scroll-arrow scroll-arrow-right",onClick:()=>p("right"),type:"button","aria-label":"Scroll tabs right",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"9,18 15,12 9,6"})})})]})}),e.jsxs("div",{className:"tab-content",children:["registro"===r&&e.jsx(n,{onSuccess:()=>{setTimeout(()=>i("asistencia"),3e3)},className:"tab-component"}),"workshop"===r&&e.jsx(l,{className:"tab-component",showHeader:!1}),"asistencia"===r&&e.jsx(m,{className:"tab-component",showHeader:!1}),"constancia"===r&&e.jsx(h,{className:"tab-component",showHeader:!1}),"concurso"===r&&e.jsx(x,{className:"tab-component"})]})]})})};export{j as default};
